<html>
<head>
  <meta charset="utf-8">
  <!-- http://garden.zendesk.com -->
  <link rel="stylesheet" href="https://assets.zendesk.com/apps/sdk-assets/css/0/zendesk_garden.css" type="text/css">
</head>
<body>
  <h2 class="u-gamma">Hello, World!</h2>
  <!-- https://github.com/zendesk/zendesk_app_framework_sdk -->
  <script type="text/javascript" src="https://assets.zendesk.com/apps/sdk/2.0/zaf_sdk.js"></script>
  <script>
    // Initialise the Zendesk JavaScript API client
    // https://developer.zendesk.com/apps/docs/apps-v2
    var client = ZAFClient.init();
    client.invoke('resize', { width: '100%', height: '200px' });
    client.get('ticket.requester.name').then(function(data) {
      console.log(data); // { "ticket.requester.name": "Mikkel Svane" }
    });
    client.get('ticket.customField:custom_field_33525369').then(function(data) {
      var hotel = data['ticket.customField:custom_field_33525369'];
      console.log(hotel);
      //console.log(data); // { "ticket.requester.name": "Mikkel Svane" }
      //search.json?query=tags:premium_support
      var fetchSelf = {
        url: '/api/v2/search.json?query=tags:' + hotel,
        type: 'GET',
        dataType: 'json'
      };
      var client = ZAFClient.init();
      client.request(fetchSelf).then(function(data2) {
        console.dir(data2);
      });
    });
    // https://developer.zendesk.com/apps/docs/apps-v2/using_sdk#working-with-requests
    var fetchSelf = {
      url: '/api/v2/users/me.json',
      type: 'GET',
      dataType: 'json'
    };
    var client = ZAFClient.init();
    client.request(fetchSelf).then(function(data) {
      console.dir(data);
    });


  </script>
</body>
</html>
